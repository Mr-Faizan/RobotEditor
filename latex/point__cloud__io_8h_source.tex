\doxysection{point\+\_\+cloud\+\_\+io.\+h}
\hypertarget{point__cloud__io_8h_source}{}\label{point__cloud__io_8h_source}\index{RobotLib/libraries/assimp/contrib/draco/src/draco/io/point\_cloud\_io.h@{RobotLib/libraries/assimp/contrib/draco/src/draco/io/point\_cloud\_io.h}}
\mbox{\hyperlink{point__cloud__io_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Copyright\ 2016\ The\ Draco\ Authors.}}
\DoxyCodeLine{00002\ \textcolor{comment}{//}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ Licensed\ under\ the\ Apache\ License,\ Version\ 2.0\ (the\ "{}License"{});}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ you\ may\ not\ use\ this\ file\ except\ in\ compliance\ with\ the\ License.}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ You\ may\ obtain\ a\ copy\ of\ the\ License\ at}}
\DoxyCodeLine{00006\ \textcolor{comment}{//}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ \ \ \ \ \ http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{00008\ \textcolor{comment}{//}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ Unless\ required\ by\ applicable\ law\ or\ agreed\ to\ in\ writing,\ software}}
\DoxyCodeLine{00010\ \textcolor{comment}{//\ distributed\ under\ the\ License\ is\ distributed\ on\ an\ "{}AS\ IS"{}\ BASIS,}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ WITHOUT\ WARRANTIES\ OR\ CONDITIONS\ OF\ ANY\ KIND,\ either\ express\ or\ implied.}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ See\ the\ License\ for\ the\ specific\ language\ governing\ permissions\ and}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ limitations\ under\ the\ License.}}
\DoxyCodeLine{00014\ \textcolor{comment}{//}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#ifndef\ DRACO\_IO\_POINT\_CLOUD\_IO\_H\_}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#define\ DRACO\_IO\_POINT\_CLOUD\_IO\_H\_}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{compression__shared_8h}{draco/compression/config/compression\_shared.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{decode_8h}{draco/compression/decode.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{expert__encode_8h}{draco/compression/expert\_encode.h}}"{}}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacedraco}{draco}}\ \{}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ OutStreamT>}
\DoxyCodeLine{00025\ OutStreamT\ \mbox{\hyperlink{namespacedraco_a8406127c1796f78a7bc5959a53cbe92d}{WritePointCloudIntoStream}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdraco_1_1_point_cloud}{PointCloud}}\ *pc,\ OutStreamT\ \&\&os,}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedraco_a429e49cfd174974db837365e4a5b5b03}{PointCloudEncodingMethod}}\ method,}
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedraco_ab66b946bef87fd44eecee018c9ce9dd3}{EncoderOptions}}\ \&options)\ \{}
\DoxyCodeLine{00028\ \ \ \mbox{\hyperlink{classdraco_1_1_encoder_buffer}{EncoderBuffer}}\ buffer;}
\DoxyCodeLine{00029\ \ \ \mbox{\hyperlink{namespacedraco_ab66b946bef87fd44eecee018c9ce9dd3}{EncoderOptions}}\ local\_options\ =\ options;}
\DoxyCodeLine{00030\ \ \ \mbox{\hyperlink{classdraco_1_1_expert_encoder}{ExpertEncoder}}\ encoder(*pc);}
\DoxyCodeLine{00031\ \ \ encoder.\mbox{\hyperlink{classdraco_1_1_expert_encoder_abfb9b5a6fc0fd4d362dddb1134902a9e}{Reset}}(local\_options);}
\DoxyCodeLine{00032\ \ \ encoder.\mbox{\hyperlink{classdraco_1_1_expert_encoder_a8a7e07c81d1f97c16487b20f04345742}{SetEncodingMethod}}(method);}
\DoxyCodeLine{00033\ \ \ \textcolor{keywordflow}{if}\ (!encoder.\mbox{\hyperlink{classdraco_1_1_expert_encoder_a171df2b83313c0d181464fe579c1dc48}{EncodeToBuffer}}(\&buffer).\mbox{\hyperlink{classdraco_1_1_status_ae41bfd7897444f6ecde6bc507cefe67d}{ok}}())\ \{}
\DoxyCodeLine{00034\ \ \ \ \ os.setstate(std::ios\_base::badbit);}
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{keywordflow}{return}\ os;}
\DoxyCodeLine{00036\ \ \ \}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \ \ os.write(\textcolor{keyword}{static\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{char}\ *\textcolor{keyword}{>}(buffer.data()),\ buffer.size());}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \ \ \textcolor{keywordflow}{return}\ os;}
\DoxyCodeLine{00041\ \}}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ OutStreamT>}
\DoxyCodeLine{00044\ OutStreamT\ \mbox{\hyperlink{namespacedraco_a8406127c1796f78a7bc5959a53cbe92d}{WritePointCloudIntoStream}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdraco_1_1_point_cloud}{PointCloud}}\ *pc,\ OutStreamT\ \&\&os,}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedraco_a429e49cfd174974db837365e4a5b5b03}{PointCloudEncodingMethod}}\ method)\ \{}
\DoxyCodeLine{00046\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedraco_ab66b946bef87fd44eecee018c9ce9dd3}{EncoderOptions}}\ options\ =\ \mbox{\hyperlink{classdraco_1_1_encoder_options_base_a63c5a94b611a68b0f177967f3a3bbf14}{EncoderOptions::CreateDefaultOptions}}();}
\DoxyCodeLine{00047\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedraco_a8406127c1796f78a7bc5959a53cbe92d}{WritePointCloudIntoStream}}(pc,\ os,\ method,\ options);}
\DoxyCodeLine{00048\ \}}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ OutStreamT>}
\DoxyCodeLine{00051\ OutStreamT\ \&\mbox{\hyperlink{namespacedraco_a8406127c1796f78a7bc5959a53cbe92d}{WritePointCloudIntoStream}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdraco_1_1_point_cloud}{PointCloud}}\ *pc,\ OutStreamT\ \&\&os)\ \{}
\DoxyCodeLine{00052\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedraco_a8406127c1796f78a7bc5959a53cbe92d}{WritePointCloudIntoStream}}(pc,\ os,\ \mbox{\hyperlink{namespacedraco_a429e49cfd174974db837365e4a5b5b03a55376ca92f67cb63302da3efd14c9ce3}{POINT\_CLOUD\_SEQUENTIAL\_ENCODING}});}
\DoxyCodeLine{00053\ \}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ InStreamT>}
\DoxyCodeLine{00056\ InStreamT\ \&\mbox{\hyperlink{namespacedraco_a7b746514524d61f0b3a7c81be18b9565}{ReadPointCloudFromStream}}(std::unique\_ptr<PointCloud>\ *point\_cloud,}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ InStreamT\ \&\&is)\ \{}
\DoxyCodeLine{00058\ \ \ \textcolor{comment}{//\ Determine\ size\ of\ stream\ and\ write\ into\ a\ vector}}
\DoxyCodeLine{00059\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ start\_pos\ =\ is.tellg();}
\DoxyCodeLine{00060\ \ \ is.seekg(0,\ std::ios::end);}
\DoxyCodeLine{00061\ \ \ \textcolor{keyword}{const}\ std::streampos\ is\_size\ =\ is.tellg()\ -\/\ start\_pos;}
\DoxyCodeLine{00062\ \ \ is.seekg(start\_pos);}
\DoxyCodeLine{00063\ \ \ std::vector<char>\ \mbox{\hyperlink{ut_default_i_o_stream_8cpp_ac89b5786f65419c30c7a97e2d5c40fe9}{data}}(is\_size);}
\DoxyCodeLine{00064\ \ \ is.read(\&\mbox{\hyperlink{ut_default_i_o_stream_8cpp_ac89b5786f65419c30c7a97e2d5c40fe9}{data}}[0],\ is\_size);}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \textcolor{comment}{//\ Create\ a\ point\ cloud\ from\ that\ data.}}
\DoxyCodeLine{00067\ \ \ \mbox{\hyperlink{classdraco_1_1_decoder_buffer}{DecoderBuffer}}\ buffer;}
\DoxyCodeLine{00068\ \ \ buffer.\mbox{\hyperlink{classdraco_1_1_decoder_buffer_aefd07f807b12270ffb8b1d943651a251}{Init}}(\&\mbox{\hyperlink{ut_default_i_o_stream_8cpp_ac89b5786f65419c30c7a97e2d5c40fe9}{data}}[0],\ \mbox{\hyperlink{ut_default_i_o_stream_8cpp_ac89b5786f65419c30c7a97e2d5c40fe9}{data}}.size());}
\DoxyCodeLine{00069\ \ \ \mbox{\hyperlink{classdraco_1_1_decoder}{Decoder}}\ decoder;}
\DoxyCodeLine{00070\ \ \ \textcolor{keyword}{auto}\ statusor\ =\ decoder.\mbox{\hyperlink{classdraco_1_1_decoder_a7c99fb8ba29b228b67c7f09fe0712931}{DecodePointCloudFromBuffer}}(\&buffer);}
\DoxyCodeLine{00071\ \ \ *point\_cloud\ =\ std::move(statusor).value();}
\DoxyCodeLine{00072\ \ \ \textcolor{keywordflow}{if}\ (!statusor.ok()\ ||\ *point\_cloud\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00073\ \ \ \ \ is.setstate(std::ios\_base::badbit);}
\DoxyCodeLine{00074\ \ \ \}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ \textcolor{keywordflow}{return}\ is;}
\DoxyCodeLine{00077\ \}}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \textcolor{comment}{//\ Reads\ a\ point\ cloud\ from\ a\ file.\ The\ function\ automatically\ chooses\ the}}
\DoxyCodeLine{00080\ \textcolor{comment}{//\ correct\ decoder\ based\ on\ the\ extension\ of\ the\ files.\ Currently,\ .obj\ and\ .ply}}
\DoxyCodeLine{00081\ \textcolor{comment}{//\ files\ are\ supported.\ Other\ file\ extensions\ are\ processed\ by\ the\ default}}
\DoxyCodeLine{00082\ \textcolor{comment}{//\ draco::PointCloudDecoder.}}
\DoxyCodeLine{00083\ \textcolor{comment}{//\ Returns\ nullptr\ with\ an\ error\ status\ if\ the\ decoding\ failed.}}
\DoxyCodeLine{00084\ StatusOr<std::unique\_ptr<PointCloud>>\ \mbox{\hyperlink{namespacedraco_a4d992a7bcaa13e674ff9a878791a2a2a}{ReadPointCloudFromFile}}(}
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&file\_name);}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \}\ \ \textcolor{comment}{//\ namespace\ draco}}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ DRACO\_IO\_POINT\_CLOUD\_IO\_H\_}}

\end{DoxyCode}
